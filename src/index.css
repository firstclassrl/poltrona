@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  --theme-background: #ffffff;
  --theme-surface: #ffffff;
  --theme-surface-alt: #f9fafb;
  --theme-primary: #25401c;
  --theme-primary-strong: #1a2f15;
  --theme-accent: #eecf54;
  --theme-accent-soft: #f5e59a;
  --theme-accent-contrast: #0f0f0c;
  --theme-text: #111827;
  --theme-text-muted: #6b7280;
  --theme-border: #e5e7eb;
  --theme-success: #22c55e;
  --theme-warning: #f59e0b;
  --theme-danger: #ef4444;
  --theme-overlay: rgba(15, 15, 15, 0.35);
  --theme-page-gradient: linear-gradient(to bottom right, #030712, rgba(88, 28, 135, 0.2), rgba(236, 72, 153, 0.2));
  --theme-sidebar-bg: rgba(37, 64, 28, 0.95);
  --theme-sidebar-border: rgba(238, 207, 84, 0.3);
  --theme-sidebar-shadow: 0 8px 32px rgba(37, 64, 28, 0.6);
  --theme-nav-active: rgba(238, 207, 84, 0.15);
  --theme-nav-hover: rgba(238, 207, 84, 0.1);
  --theme-sidebar-text: #f8fafc;
}

body {
  background: var(--theme-background);
  color: var(--theme-text);
}

.app-theme-bg {
  background: var(--theme-page-gradient);
  color: var(--theme-text);
}

.app-gradient {
  background: var(--theme-page-gradient);
}

.surface-card {
  background: var(--theme-surface);
  color: var(--theme-text);
  border: 1px solid color-mix(in srgb, var(--theme-border) 25%, transparent);
}

.surface-card-alt {
  background: var(--theme-surface-alt);
}

.text-on-surface {
  color: var(--theme-text);
}

.text-muted {
  color: var(--theme-text-muted);
}

.border-theme {
  border-color: color-mix(in srgb, var(--theme-border) 60%, transparent);
}

.bg-primary-strong {
  background-color: var(--theme-primary-strong);
}

.bg-primary {
  background-color: var(--theme-primary);
}

[data-theme]:not([data-theme='heritage']) body {
  background: var(--theme-background);
  color: var(--theme-text);
}

[data-theme]:not([data-theme='heritage']) .bg-white {
  background-color: var(--theme-surface) !important;
}

[data-theme]:not([data-theme='heritage']) .bg-gray-50 {
  background-color: var(--theme-surface-alt) !important;
}

[data-theme]:not([data-theme='heritage']) .bg-gray-100 {
  background-color: color-mix(in srgb, var(--theme-surface) 92%, var(--theme-text) 8%) !important;
}

[data-theme]:not([data-theme='heritage']) .border-gray-200 {
  border-color: color-mix(in srgb, var(--theme-border) 25%, transparent) !important;
}

[data-theme]:not([data-theme='heritage']) .border-gray-300 {
  border-color: color-mix(in srgb, var(--theme-border) 40%, transparent) !important;
}

[data-theme]:not([data-theme='heritage']) .text-gray-900,
[data-theme]:not([data-theme='heritage']) .text-gray-800 {
  color: var(--theme-text) !important;
}

[data-theme]:not([data-theme='heritage']) .text-gray-700,
[data-theme]:not([data-theme='heritage']) .text-gray-600 {
  color: var(--theme-text-muted) !important;
}

[data-theme]:not([data-theme='heritage']) .text-gray-500 {
  color: color-mix(in srgb, var(--theme-text) 60%, transparent) !important;
}

[data-theme]:not([data-theme='heritage']) .bg-gray-200 {
  background-color: color-mix(in srgb, var(--theme-surface) 85%, var(--theme-text) 15%) !important;
}

[data-theme]:not([data-theme='heritage']) .bg-gray-300 {
  background-color: color-mix(in srgb, var(--theme-surface) 78%, var(--theme-text) 22%) !important;
}

[data-theme]:not([data-theme='heritage']) .bg-gray-400 {
  background-color: color-mix(in srgb, var(--theme-surface) 68%, var(--theme-text) 32%) !important;
}

[data-theme]:not([data-theme='heritage']) .shadow-lg,
[data-theme]:not([data-theme='heritage']) .shadow-md,
[data-theme]:not([data-theme='heritage']) .shadow-sm {
  box-shadow: 0 10px 30px color-mix(in srgb, var(--theme-primary-strong) 18%, transparent);
}

[data-theme]:not([data-theme='heritage']) .text-green-800,
[data-theme]:not([data-theme='heritage']) .text-green-700,
[data-theme]:not([data-theme='heritage']) .text-green-600,
[data-theme]:not([data-theme='heritage']) .text-green-500 {
  color: var(--theme-primary) !important;
}

[data-theme]:not([data-theme='heritage']) .bg-green-900 { background-color: color-mix(in srgb, var(--theme-primary-strong) 92%, var(--theme-primary)) !important; }
[data-theme]:not([data-theme='heritage']) .bg-green-800 { background-color: color-mix(in srgb, var(--theme-primary-strong) 82%, var(--theme-primary)) !important; }
[data-theme]:not([data-theme='heritage']) .bg-green-700 { background-color: var(--theme-primary-strong) !important; }
[data-theme]:not([data-theme='heritage']) .bg-green-600 { background-color: color-mix(in srgb, var(--theme-primary) 85%, transparent) !important; }
[data-theme]:not([data-theme='heritage']) .bg-green-500 { background-color: color-mix(in srgb, var(--theme-primary) 75%, transparent) !important; }
[data-theme]:not([data-theme='heritage']) .bg-green-400 { background-color: color-mix(in srgb, var(--theme-primary) 60%, var(--theme-surface)) !important; }
[data-theme]:not([data-theme='heritage']) .bg-green-300 { background-color: color-mix(in srgb, var(--theme-primary) 45%, var(--theme-surface)) !important; }
[data-theme]:not([data-theme='heritage']) .bg-green-200 { background-color: color-mix(in srgb, var(--theme-primary) 30%, var(--theme-surface)) !important; }
[data-theme]:not([data-theme='heritage']) .bg-green-100 { background-color: color-mix(in srgb, var(--theme-primary) 18%, var(--theme-surface)) !important; }
[data-theme]:not([data-theme='heritage']) .bg-green-50  { background-color: color-mix(in srgb, var(--theme-primary) 10%, var(--theme-surface)) !important; }

[data-theme]:not([data-theme='heritage']) .border-green-600 { border-color: color-mix(in srgb, var(--theme-primary) 70%, transparent) !important; }
[data-theme]:not([data-theme='heritage']) .border-green-300 { border-color: color-mix(in srgb, var(--theme-primary) 40%, transparent) !important; }
[data-theme]:not([data-theme='heritage']) .focus\:ring-green-500:focus,
[data-theme]:not([data-theme='heritage']) .focus\:ring-green-500:focus-visible {
  box-shadow: 0 0 0 2px color-mix(in srgb, var(--theme-primary) 70%, transparent) !important;
}

/* Sidebar text overrides for non-heritage themes to ensure contrast */
[data-theme]:not([data-theme='heritage']) .glass-sidebar-dark,
[data-theme]:not([data-theme='heritage']) .glass-sidebar-dark * {
  color: var(--theme-sidebar-text) !important;
}
[data-theme]:not([data-theme='heritage']) .glass-sidebar-dark .border,
[data-theme]:not([data-theme='heritage']) .glass-sidebar-dark .border-l-2,
[data-theme]:not([data-theme='heritage']) .glass-sidebar-dark .border-l-4 {
  border-color: color-mix(in srgb, var(--theme-sidebar-text) 30%, transparent) !important;
}
[data-theme]:not([data-theme='heritage']) .glass-sidebar-dark button:hover {
  background-color: color-mix(in srgb, var(--theme-sidebar-text) 12%, transparent) !important;
}

[data-theme]:not([data-theme='heritage']) .text-yellow-300,
[data-theme]:not([data-theme='heritage']) .text-yellow-400 {
  color: var(--theme-accent) !important;
}
[data-theme]:not([data-theme='heritage']) .bg-yellow-500 { background-color: var(--theme-accent) !important; }
[data-theme]:not([data-theme='heritage']) .bg-yellow-500\/10 { background-color: color-mix(in srgb, var(--theme-accent) 10%, transparent) !important; }
[data-theme]:not([data-theme='heritage']) .bg-yellow-500\/15 { background-color: color-mix(in srgb, var(--theme-accent) 15%, transparent) !important; }
[data-theme]:not([data-theme='heritage']) .bg-yellow-500\/5 { background-color: color-mix(in srgb, var(--theme-accent) 5%, transparent) !important; }
[data-theme]:not([data-theme='heritage']) .bg-yellow-200 { background-color: color-mix(in srgb, var(--theme-accent) 30%, var(--theme-surface)) !important; }
[data-theme]:not([data-theme='heritage']) .bg-yellow-100 { background-color: color-mix(in srgb, var(--theme-accent) 20%, var(--theme-surface)) !important; }
[data-theme]:not([data-theme='heritage']) .bg-yellow-50  { background-color: color-mix(in srgb, var(--theme-accent) 12%, var(--theme-surface)) !important; }
[data-theme]:not([data-theme='heritage']) .border-yellow-400 { border-color: color-mix(in srgb, var(--theme-accent) 60%, transparent) !important; }
[data-theme]:not([data-theme='heritage']) .border-yellow-400\/30 { border-color: color-mix(in srgb, var(--theme-accent) 30%, transparent) !important; }
[data-theme]:not([data-theme='heritage']) .border-yellow-400\/40 { border-color: color-mix(in srgb, var(--theme-accent) 40%, transparent) !important; }
[data-theme]:not([data-theme='heritage']) .focus\:ring-yellow-500:focus,
[data-theme]:not([data-theme='heritage']) .focus\:ring-yellow-500:focus-visible {
  box-shadow: 0 0 0 2px color-mix(in srgb, var(--theme-accent) 70%, transparent) !important;
}

[data-theme]:not([data-theme='heritage']) .brand-green { background-color: var(--theme-primary); }
[data-theme]:not([data-theme='heritage']) .brand-yellow { color: var(--theme-accent); }
[data-theme]:not([data-theme='heritage']) .brand-yellow-bg { background-color: var(--theme-accent); }
[data-theme]:not([data-theme='heritage']) .brand-green-text { color: var(--theme-primary); }
[data-theme]:not([data-theme='heritage']) .brand-border-yellow { border-color: var(--theme-accent); }
[data-theme]:not([data-theme='heritage']) .brand-hover-green:hover { background-color: color-mix(in srgb, var(--theme-primary) 80%, transparent); }
[data-theme]:not([data-theme='heritage']) .brand-hover-yellow:hover { background-color: color-mix(in srgb, var(--theme-accent) 12%, transparent); }

/* Sidebar text/icons forced to white SOLO per temi non-heritage (escluso dark-mode) */
[data-theme]:not([data-theme='heritage']):not([data-theme='dark-mode']) .glass-sidebar-dark,
[data-theme]:not([data-theme='heritage']):not([data-theme='dark-mode']) .glass-sidebar-dark button,
[data-theme]:not([data-theme='heritage']):not([data-theme='dark-mode']) .glass-sidebar-dark a,
[data-theme]:not([data-theme='heritage']):not([data-theme='dark-mode']) .glass-sidebar-dark span,
[data-theme]:not([data-theme='heritage']):not([data-theme='dark-mode']) .glass-sidebar-dark svg {
  color: #ffffff !important;
}
[data-theme]:not([data-theme='heritage']):not([data-theme='dark-mode']) .glass-sidebar-dark svg {
  stroke: #ffffff !important;
}

/* Dark Mode: sidebar con icone e testi arancioni */
[data-theme='dark-mode'] .glass-sidebar-dark,
[data-theme='dark-mode'] .glass-sidebar-dark button,
[data-theme='dark-mode'] .glass-sidebar-dark a,
[data-theme='dark-mode'] .glass-sidebar-dark span,
[data-theme='dark-mode'] .glass-sidebar-dark svg {
  color: var(--theme-accent) !important;
}
[data-theme='dark-mode'] .glass-sidebar-dark svg {
  stroke: var(--theme-accent) !important;
}

/* Rimuovi override Aurora: usa i token di palette (testo scuro su fondo chiaro) */

/* Dark Mode: card nere con bordo arancione, solo testi bianchi/arancioni */
[data-theme='dark-mode'] .bg-white,
[data-theme='dark-mode'] .surface-card,
[data-theme='dark-mode'] .surface-card-alt,
[data-theme='dark-mode'] .bg-gray-50,
[data-theme='dark-mode'] .bg-gray-100 {
  background-color: #0a0a0a !important;
  border-color: var(--theme-border) !important;
  border-width: 1px !important;
}

[data-theme='dark-mode'] .text-gray-900,
[data-theme='dark-mode'] .text-gray-800,
[data-theme='dark-mode'] .text-gray-700,
[data-theme='dark-mode'] .text-gray-600,
[data-theme='dark-mode'] .text-gray-500,
[data-theme='dark-mode'] .text-black {
  color: #ffffff !important;
}

[data-theme='dark-mode'] .text-gray-400,
[data-theme='dark-mode'] .text-gray-300 {
  color: var(--theme-accent) !important;
}

[data-theme='dark-mode'] .border-gray-200,
[data-theme='dark-mode'] .border-gray-300 {
  border-color: var(--theme-border) !important;
}

/* Dark Mode: riduci drasticamente i glow arancioni sotto le card */
[data-theme='dark-mode'] .shadow-lg,
[data-theme='dark-mode'] .shadow-md,
[data-theme='dark-mode'] .shadow-sm,
[data-theme='dark-mode'] .shadow {
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3) !important;
}

[data-theme='dark-mode'] .app-theme-bg {
  background: #000000 !important;
}

[data-theme='dark-mode'] .glass-sidebar-dark {
  background: #000000 !important;
  border-color: transparent !important;
}

/* Rimuovi tutti i bordi dalla sidebar in dark-mode */
[data-theme='dark-mode'] .glass-sidebar-dark .border,
[data-theme='dark-mode'] .glass-sidebar-dark .border-l-2,
[data-theme='dark-mode'] .glass-sidebar-dark .border-l-4,
[data-theme='dark-mode'] .glass-sidebar-dark .border-r,
[data-theme='dark-mode'] .glass-sidebar-dark .border-t,
[data-theme='dark-mode'] .glass-sidebar-dark .border-b {
  border-color: transparent !important;
  border-width: 0 !important;
}

[data-theme='dark-mode'] .glass-sidebar-dark button,
[data-theme='dark-mode'] .glass-sidebar-dark span,
[data-theme='dark-mode'] .glass-sidebar-dark p {
  color: var(--theme-accent) !important;
}

[data-theme='dark-mode'] .glass-sidebar-dark button:hover {
  color: #ffffff !important;
}

/* Dark Mode: due lineette di separazione arancioni nella sidebar */
[data-theme='dark-mode'] .dark-mode-separator-top,
[data-theme='dark-mode'] .dark-mode-separator-bottom {
  display: block !important;
  border-color: var(--theme-accent) !important;
  border-width: 1px !important;
  opacity: 0.6;
}

/* Dark Mode: tasto notifiche con bordo arancione */
[data-theme='dark-mode'] .dark-mode-notification-button {
  border-color: var(--theme-accent) !important;
  border-width: 1px !important;
}

/* Dark Mode: quadrati calendario arancioni scuri */
[data-theme='dark-mode'] .calendar-time-slot {
  background-color: var(--theme-primary-strong) !important;
  border-color: var(--theme-accent) !important;
}

[data-theme='dark-mode'] .calendar-time-slot:hover {
  background-color: var(--theme-primary) !important;
}

[data-theme='dark-mode'] .calendar-time-slot.bg-gray-200 {
  background-color: color-mix(in srgb, var(--theme-primary-strong) 80%, black) !important;
}

/* Dark Mode: card prossimi appuntamenti nere con bordo arancione */
[data-theme='dark-mode'] .dashboard-appointment-card {
  background-color: #0a0a0a !important;
  border-color: var(--theme-border) !important;
  border-width: 1px !important;
}

[data-theme='dark-mode'] .dashboard-appointment-card:hover {
  border-color: var(--theme-accent) !important;
}

/* Force 24-hour format for time inputs */
@layer utilities {
  input[type="time"][data-format="24"] {
    /* Force 24-hour format display */
    -webkit-appearance: none;
    -moz-appearance: textfield;
  }
  
  input[type="time"][data-format="24"]::-webkit-datetime-edit-ampm-field {
    display: none !important;
  }
  
  input[type="time"][data-format="24"]::-webkit-datetime-edit-hour-field,
  input[type="time"][data-format="24"]::-webkit-datetime-edit-minute-field {
    -webkit-appearance: none;
    margin: 0;
  }

  /* Force 24-hour format for all time inputs in the app */
  input[type="time"],
  .time-24h {
    -webkit-appearance: none;
    -moz-appearance: textfield;
  }
  
  input[type="time"]::-webkit-datetime-edit-ampm-field,
  .time-24h::-webkit-datetime-edit-ampm-field {
    display: none !important;
  }

  /* Additional 24-hour format enforcement */
  .time-24h::-webkit-datetime-edit-hour-field,
  .time-24h::-webkit-datetime-edit-minute-field {
    -webkit-appearance: none;
    margin: 0;
  }

  /* Force Italian date format for date inputs */
  input[type="date"][lang="it-IT"] {
    /* Force Italian date format display */
    -webkit-appearance: none;
    -moz-appearance: textfield;
  }
  
  input[type="date"][lang="it-IT"]::-webkit-datetime-edit-text {
    color: #6b7280;
  }
  
  input[type="date"][lang="it-IT"]::-webkit-datetime-edit-month-field,
  input[type="date"][lang="it-IT"]::-webkit-datetime-edit-day-field,
  input[type="date"][lang="it-IT"]::-webkit-datetime-edit-year-field {
    -webkit-appearance: none;
    margin: 0;
  }
}

/* Login liquid-glass helpers (conservano palette attuale) */
@layer components {
  .login-liquid {
    position: relative;
    isolation: isolate;
  }

  .login-liquid::after {
    content: '';
    position: absolute;
    inset: -10%;
    background:
      radial-gradient(60% 60% at 20% 15%, rgba(255, 255, 255, 0.08), transparent 40%),
      radial-gradient(50% 50% at 80% 20%, rgba(255, 255, 255, 0.06), transparent 45%),
      radial-gradient(70% 70% at 50% 90%, rgba(255, 255, 255, 0.05), transparent 50%);
    filter: blur(28px);
    pointer-events: none;
    z-index: 0;
  }

  .login-grain {
    position: absolute;
    inset: 0;
    background-image: radial-gradient(rgba(255, 255, 255, 0.06) 1px, transparent 0);
    background-size: 28px 28px;
    opacity: 0.12;
    mix-blend-mode: soft-light;
    pointer-events: none;
    z-index: 1;
  }

  .login-card-glass {
    position: relative;
    backdrop-filter: blur(18px) saturate(140%);
    -webkit-backdrop-filter: blur(18px) saturate(140%);
    box-shadow:
      0 15px 45px rgba(0, 0, 0, 0.35),
      inset 0 1px 0 rgba(255, 255, 255, 0.18);
    overflow: hidden;
  }

  .login-card-glass::before {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(180deg, rgba(255, 255, 255, 0.18), transparent 45%);
    pointer-events: none;
  }
}

/* Custom Glass Effect for Sidebar */
@layer components {
  .glass-sidebar-dark {
  /* Darker black glass background with more opacity */
  background: rgba(37, 64, 28, 0.95); /* #25401c with opacity */
  
  /* Enhanced frosted glass effect */
  backdrop-filter: blur(25px) saturate(180%);
  -webkit-backdrop-filter: blur(25px) saturate(180%);
  
  /* More defined border for better contrast */
  border: 1px solid rgba(238, 207, 84, 0.3); /* Yellow border */
  
  /* Deeper shadows for more dramatic effect */
  box-shadow: 
    0 8px 32px rgba(37, 64, 28, 0.6),
    0 0 0 1px rgba(238, 207, 84, 0.1),
    inset 0 1px 0 rgba(238, 207, 84, 0.15);
  color: var(--theme-sidebar-text);
  }
  
  .glass-nav-item {
    backdrop-filter: blur(15px) saturate(150%);
    -webkit-backdrop-filter: blur(15px) saturate(150%);
    
    box-shadow: 
      inset 0 1px 0 color-mix(in srgb, var(--theme-border) 25%, transparent),
      0 2px 8px color-mix(in srgb, var(--theme-primary) 35%, transparent);
  }
  
  /* Fallback for browsers that don't support backdrop-filter */
  @supports not (backdrop-filter: blur()) {
    .glass-sidebar-dark {
      background: color-mix(in srgb, var(--theme-primary-strong) 92%, transparent);
    }
  }

  /* Brand Color Utilities */
  .brand-green {
    background-color: var(--theme-primary);
  }
  
  .brand-yellow {
    color: var(--theme-accent);
  }
  
  .brand-yellow-bg {
    background-color: var(--theme-accent);
  }
  
  .brand-green-text {
    color: var(--theme-primary);
  }
  
  .brand-border-yellow {
    border-color: var(--theme-accent);
  }
  
  .brand-hover-green:hover {
    background-color: color-mix(in srgb, var(--theme-primary) 80%, transparent);
  }
  
  .brand-hover-yellow:hover {
    background-color: color-mix(in srgb, var(--theme-accent) 10%, transparent);
  }
}